<!DOCTYPE html>
<html>
<head>
  <title>Get in here!</title>

  <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

  <style>

  body {
    background: #c2e59c; /* fallback for old browsers */
    background: -webkit-linear-gradient(to left, #c2e59c , #64b3f4); /* Chrome 10-25, Safari 5.1-6 */
    background: linear-gradient(to left, #c2e59c , #64b3f4); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    font-family: Arial;
    background-size: cover;
    height:100%;
  }
  h1 {
    text-align: center;
    color: yellow;
    text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
  }
  ul{
    overflow: scroll;
  }
  li {
    color: yellow;
    text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
  }
  input{
    border: 3px solid yellow;
    border-radius: 10px;
    width: 215px;
    box-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
  }
  input:focus{
    outline: none;
  }
  #messages {
    margin: 0 auto;
    height: 250px;
    width: 400px;
    border: 3px solid yellow;
    border-radius: 10px;
    box-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
  }
  #form {
    text-align: center;
  }
  </style>

</head>
<body>

<h1>Get in here!</h1>
<ul id='messages'></ul>
<form id='form'>
  <input id='msg' placeholder='Type a message' />
  <input type='submit' value='Send Message'/>
</form>

<script>
  //Inititalize socket
  var socket = io();

  //Event handler for submitting message
  $('#form').on('submit', function(e){
    //Prevents page refresh on submit
    e.preventDefault();
    //Checks that text box is not empty
    if ($('#msg').val() !== ''){
      //Sets variable message to text box contents
      var message = $('#msg').val()
      //mits chat message to server
      socket.emit('chat message', message);
      //Resets text box to be empty
      $('#msg').val('');
    }
  });

  //Event handler when chat message is received
  socket.on('chat message', function(message){
    //Appends message to 
    $('#messages').append($('<li>').text(message));
    //Giphy API call and changes background to url
    $.getJSON('https://api.giphy.com/v1/gifs/search?q='+message+'&api_key=dc6zaTOxFJmzC', function(results){
      //Set variable url to first result's property for original url
      var url = results.data[0].images.original.url
      //Set background image to url
      $('body').css('background-image','url('+url+')')
    });
    //Autoscrolls chat list to bottom
    var objDiv = document.getElementById("messages");
    objDiv.scrollTop = objDiv.scrollHeight;
  });

</script>

</body>
</html>